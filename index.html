<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WaveX - Rhythm Game</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <canvas id="bgCanvas"></canvas>
    <div id="app">
        <header id="topBar">
            <div class="logo">WaveX</div>
            <div class="spacer"></div>
            <div id="userBadge">
                <img id="userAvatar" alt="avatar" />
                <div id="userInfo">
                    <div id="userName">Guest</div>
                    <div id="userLevel">Lv. 1</div>
                </div>
            </div>
        </header>

        <main id="screens">
            <!-- Main Menu -->
            <section id="screen-main" class="screen active">
                <div class="menu">
                    <button class="btn primary" data-nav="screen-select">Play</button>
                    <button class="btn" data-nav="screen-editor">Editor</button>
                    <button class="btn" data-nav="screen-community">Community Charts</button>
                    <button class="btn" data-nav="screen-profile">Profile</button>
                    <button class="btn" data-nav="screen-options">Options</button>
                    <button class="btn admin-btn" onclick="showAdminLogin()">Admin Panel</button>
                    <button class="btn test-btn" onclick="testFileAccess()">Test Files</button>
                </div>

                <div class="card" style="margin:16px auto; width:min(860px,95vw)">
<pre style="white-space:pre-wrap; margin:0; font-size:12px; color:#93a0c7">JSON Chart Structure Example:
{
  "id": "unique-id",
  "title": "Song Name",
  "artist": "Artist",
  "mp3": "https://example.com/song.mp3"  // or "data:audio/mpeg;base64,...",
  "offset": 0,
  "difficulty": "Normal",
  "notes": [
    { "time": 1.54, "lane": 1 },
    { "time": 2.13, "lane": 2 },
    { "time": 2.47, "lane": 3 },
    { "time": 2.80, "lane": 4 }
  ]
}
</pre>
                </div>
            </section>

            <!-- Song Select -->
            <section id="screen-select" class="screen">
                <div class="toolbar">
                    <button class="btn" data-nav="screen-main">← Back</button>
                    <div class="filters">
                        <label>Search <input id="songSearch" type="text" placeholder="Song, artist, chart..." /></label>
                        <label>Difficulty
                            <select id="difficultyFilter">
                                <option value="">All</option>
                                <option>Easy</option>
                                <option>Normal</option>
                                <option>Hard</option>
                                <option>Insane</option>
                            </select>
                        </label>
                    </div>
                </div>
                <div id="songList" class="list"></div>
            </section>

            <!-- Game Screen -->
            <section id="screen-game" class="screen">
                <div class="hud">
                    <div class="left">
                        <div id="hudScore">0000000</div>
                        <div id="hudAcc">100.00%</div>
                        <div id="hudCombo">0x</div>
                    </div>
                    <div class="center">
                        <div id="countdown"></div>
                    </div>
                    <div class="right">
                        <div id="hudMods"></div>
                        <button id="pauseBtn" class="btn small">Pause</button>
                    </div>
                </div>
                <div id="gameArea">
                    <canvas id="gameCanvas"></canvas>
                    <div id="laneKeys">
                        <div class="laneKey" data-lane="1">D</div>
                        <div class="laneKey" data-lane="2">F</div>
                        <div class="laneKey" data-lane="3">J</div>
                        <div class="laneKey" data-lane="4">K</div>
                    </div>
                    <div id="judgeLine"></div>
                    <div id="healthBar"><div id="healthFill"></div></div>
                </div>
                <div id="pauseMenu" class="modal hidden">
                    <div class="modal-content">
                        <h2>Paused</h2>
                        <button id="resumeBtn" class="btn primary">Resume</button>
                        <button id="restartBtn" class="btn">Restart</button>
                        <button id="quitBtn" class="btn">Quit</button>
                    </div>
                </div>
                <div id="resultMenu" class="modal hidden">
                    <div class="modal-content">
                        <h2>Results</h2>
                        <div id="resultStats"></div>
                        <button id="resultRetry" class="btn">Retry</button>
                        <button id="resultToSelect" class="btn">Song Select</button>
                    </div>
                </div>
            </section>

            <!-- Editor -->
            <section id="screen-editor" class="screen">
                <div class="toolbar">
                    <button class="btn" data-nav="screen-main">← Back</button>
                    <div class="group">
                        <input id="editorTitle" type="text" placeholder="Title" />
                        <input id="editorArtist" type="text" placeholder="Artist" />
                        <input id="editorDiff" type="text" placeholder="Difficulty (Easy/Hard...)" />
                    </div>
                    <div class="group">
                        <label class="file">
                            <input id="mp3File" type="file" accept="audio/*" />
                            <span>Upload MP3</span>
                        </label>
                        <button id="editorLoad" class="btn">Load</button>
                        <button id="editorSaveMp3" class="btn">Save MP3 As…</button>
                    </div>
                    <div class="group">
                        <label class="file">
                            <input id="artworkFile" type="file" accept="image/*" />
                            <span>Upload Artwork</span>
                        </label>
                    </div>
                    <div class="group">
                        <button id="editorPlay" class="btn">Play</button>
                        <button id="editorPause" class="btn">Pause</button>
                        <label>Zoom <input id="timelineZoom" type="range" min="1" max="10" value="3" /></label>
                        <label>Offset <input id="editorOffset" type="number" step="0.01" value="0" /></label>
                    </div>
                    <div class="group">
                        <button id="editorExport" class="btn primary">Export JSON</button>
                        <button id="editorClear" class="btn">Clear Notes</button>
                        <button id="editorUndo" class="btn">Undo</button>
                        <span id="editorStatus" style="color:#93a0c7;font-size:12px"></span>
                    </div>
                    <div class="group">
                        <button id="editorSave" class="btn primary">Save Draft</button>
                        <button id="editorPublish" class="btn">Publish</button>
                    </div>
                </div>
                <div id="editorArea">
                    <canvas id="timelineCanvas"></canvas>
                    <div id="editorLanes">
                        <div class="lane" data-lane="1"></div>
                        <div class="lane" data-lane="2"></div>
                        <div class="lane" data-lane="3"></div>
                        <div class="lane" data-lane="4"></div>
                        <div id="editorJudgeLine"></div>
                    </div>
                    <div id="editorHelp">Place notes with D/F/J/K. Delete last: Backspace. Move cursor: ← →. Snap: Shift for fine.</div>
                </div>
            </section>

            <!-- Community -->
            <section id="screen-community" class="screen">
                <div class="toolbar">
                    <button class="btn" data-nav="screen-main">← Back</button>
                    <div class="group">
                        <button id="refreshCommunity" class="btn">Refresh</button>
                    </div>
                </div>
                <div id="communityList" class="list"></div>
            </section>

            <!-- Profile -->
            <section id="screen-profile" class="screen">
                <div class="toolbar">
                    <button class="btn" data-nav="screen-main">← Back</button>
                </div>
                <div class="profile">
                    <div class="card">
                        <label>Username <input id="profileName" type="text" placeholder="Enter username" /></label>
                        <label>Avatar <input id="profileAvatar" type="file" accept="image/*" /></label>
                    </div>
                    <div class="stats card">
                        <div><b>Level:</b> <span id="profileLevel">1</span></div>
                        <div><b>XP:</b> <span id="profileXP">0</span></div>
                        <div><b>Plays:</b> <span id="profilePlays">0</span></div>
                        <div><b>Best Acc:</b> <span id="profileBestAcc">0%</span></div>
                    </div>
                    <div class="unlocks card">
                        <h3>Unlocks</h3>
                        <div id="unlockGrid"></div>
                    </div>
                </div>
            </section>

            <!-- Options -->
            <section id="screen-options" class="screen">
                <div class="toolbar">
                    <button class="btn" data-nav="screen-main">← Back</button>
                </div>
                <div class="options">
                    <div class="card">
                        <h3>Audio</h3>
                        <label>Master Volume <input id="optVolume" type="range" min="0" max="1" step="0.01" /></label>
                        <label>Hit Sound Volume <input id="optHitVolume" type="range" min="0" max="1" step="0.01" /></label>
                    </div>
                    <div class="card">
                        <h3>Gameplay</h3>
                        <label>Scroll Speed <input id="optSpeed" type="range" min="1" max="12" step="1" /></label>
                        <label><input id="optMirror" type="checkbox" /> Mirror Lanes</label>
                        <label><input id="optFadeIn" type="checkbox" /> Fade-In Notes</label>
                        <label><input id="optHealth" type="checkbox" checked /> Health Enabled</label>
                    </div>
                    <div class="card">
                        <h3>Theme</h3>
                        <select id="optTheme">
                            <option value="neon">Neon (Default)</option>
                            <option value="ice">Ice</option>
                            <option value="sunset">Sunset</option>
                            <option value="mono">Mono</option>
                        </select>
                    </div>
                    <div class="card">
                        <h3>Controls</h3>
                        <div>Keys: D F J K</div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <audio id="mp3Audio" crossorigin="anonymous"></audio>

    <!-- Admin Panel Modal -->
    <div id="adminModal" class="modal hidden">
        <div class="modal-content admin-modal">
            <!-- Admin Login -->
            <div id="adminLogin">
                <div class="admin-header">
                    <h2>🔐 Admin Panel</h2>
                    <button class="close-btn" onclick="hideAdminPanel()">&times;</button>
                </div>
                <div class="admin-section">
                    <h3>Enter Admin Password</h3>
                    <input type="password" id="adminPassword" placeholder="Enter password" />
                    <div id="adminError" class="error-message hidden"></div>
                    <button class="btn primary" onclick="adminLogin()">Login</button>
                </div>
            </div>

            <!-- Admin Dashboard -->
            <div id="adminDashboard" class="hidden">
                <div class="admin-header">
                    <h2>⚙️ Admin Dashboard</h2>
                    <button class="close-btn" onclick="hideAdminPanel()">&times;</button>
                </div>
                <div class="admin-section">
                    <h3>Uploaded Songs</h3>
                    <div class="admin-toolbar">
                        <input type="text" id="adminSearch" placeholder="Search songs..." />
                        <button class="btn" onclick="refreshAdminSongs()">Refresh</button>
                    </div>
                    <div id="adminSongsList" class="admin-songs-list">
                        <div class="loading">Loading songs...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>

 